<%- include('../partials/page-header', {
  title,
  description: 'Strukturiere dein Team in Abteilungen und Zuständigkeitsbereiche.'
}) %>

<div class="row g-4">
  <div class="col-lg-7">
    <% if (!departments.length) { %>
      <div class="alert alert-info">Es wurden noch keine Abteilungen angelegt.</div>
    <% } else { %>
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>Name</th>
              <th>Erstellt am</th>
              <th class="text-end">Aktionen</th>
            </tr>
          </thead>
          <tbody>
            <% departments.forEach(department => { %>
              <tr>
                <td><strong><%= department.name %></strong></td>
                <td>
                  <% if (department.created_at) { %>
                    <%= new Date(department.created_at).toLocaleDateString('de-DE') %>
                  <% } else { %>
                    –
                  <% } %>
                </td>
                <td class="text-end">
                  <form method="post" action="/departments/<%= department.id %>/delete" class="d-inline">
                    <button type="submit" class="btn btn-sm btn-outline-danger" onclick="return confirm('Abteilung wirklich löschen?');">
                      Löschen
                    </button>
                  </form>
                </td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    <% } %>
  </div>
  <div class="col-lg-5">
    <div class="card p-4">
      <h3 class="h5">Neue Abteilung anlegen</h3>
      <p class="text-muted">Abteilungen helfen dabei, Mitarbeiter nach Verantwortungsbereichen zu strukturieren.</p>
      <%- include('../partials/errors', { errors }) %>
      <form method="post" action="/departments" class="mt-3">
        <div class="mb-3">
          <label for="name" class="form-label">Abteilungsname *</label>
          <input type="text" class="form-control" id="name" name="name" required value="<%= values.name %>" />
        </div>
        <button type="submit" class="btn btn-primary">Speichern</button>
      </form>
    </div>
  </div>
</div>
