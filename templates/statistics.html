{% extends "layout.html" %}
{% block title %}Meine Statistik - Dienstplaner{% endblock %}
{% block content %}
<div style="margin-bottom: 2rem;">
  <h1 style="display: flex; align-items: center; margin-bottom: 0.5rem;">
    <span style="margin-right: 0.75rem; font-size: 2rem;">📊</span>
    Statistik für {{ user.name }}
  </h1>
  <p style="color: #64748b; font-size: 1.125rem; margin: 0;">Arbeitszeit-Übersicht für {{ '%02d'|format(month) }}/{{ year }}</p>
</div>

<!-- Statistik-Karten -->
<div class="row" style="margin-bottom: 2rem;">
  <div class="col-md-4">
    <div class="card" style="background: linear-gradient(135deg, #059669 0%, #10b981 100%); color: white; border: none;">
      <div class="card-body" style="text-align: center;">
        <div style="font-size: 3rem; margin-bottom: 1rem;">⏰</div>
        <h3 style="color: white; margin-bottom: 0.5rem;">{{ '%.1f'|format(total_hours) }}h</h3>
        <p style="color: rgba(255,255,255,0.9); margin: 0; font-size: 0.875rem;">Genehmigte Stunden</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <div class="card" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; border: none;">
      <div class="card-body" style="text-align: center;">
        <div style="font-size: 3rem; margin-bottom: 1rem;">📅</div>
        <h3 style="color: white; margin-bottom: 0.5rem;">{{ shifts|length }}</h3>
        <p style="color: rgba(255,255,255,0.9); margin: 0; font-size: 0.875rem;">Arbeitstage</p>
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <div class="card" style="background: linear-gradient(135deg, #d97706 0%, #f59e0b 100%); color: white; border: none;">
      <div class="card-body" style="text-align: center;">
        <div style="font-size: 3rem; margin-bottom: 1rem;">📈</div>
        <h3 style="color: white; margin-bottom: 0.5rem;">
          {% if user.monthly_hours and total_hours > 0 %}
            {{ '%.0f'|format((total_hours / user.monthly_hours * 100)) }}%
          {% else %}
            –
          {% endif %}
        </h3>
        <p style="color: rgba(255,255,255,0.9); margin: 0; font-size: 0.875rem;">Soll-Erfüllung</p>
      </div>
    </div>
  </div>
</div>

<!-- Detaillierte Schichten -->
<div class="card">
  <div class="card-header">
    <h3 style="margin: 0; display: flex; align-items: center;">
      <span style="margin-right: 0.75rem;">📋</span>
      Detaillierte Schichten ({{ shifts|length }})
    </h3>
  </div>
  <div class="card-body" style="padding: 0;">
    {% if shifts %}
    <div style="overflow-x: auto;">
      <table class="table" style="margin: 0;">
        <thead>
          <tr>
            <th style="padding: 1.5rem 1rem;">
              <span style="margin-right: 0.5rem;">📅</span>Datum
            </th>
            <th style="padding: 1.5rem 1rem;">
              <span style="margin-right: 0.5rem;">⏰</span>Stunden
            </th>
            <th style="padding: 1.5rem 1rem;">
              <span style="margin-right: 0.5rem;">🏷️</span>Typ
            </th>
            <th style="padding: 1.5rem 1rem;">
              <span style="margin-right: 0.5rem;">✅</span>Status
            </th>
          </tr>
        </thead>
        <tbody>
          {% for s in shifts %}
          <tr>
            <td style="padding: 1rem; font-weight: 500;">{{ s.date.strftime('%d.%m.%Y') }}</td>
            <td style="padding: 1rem;">
              <span style="font-weight: 600; color: #059669;">{{ '%.1f'|format(s.hours) }}h</span>
            </td>
            <td style="padding: 1rem;">
              {% if s.shift_type %}
                <span class="badge" style="background-color: #64748b;">{{ s.shift_type }}</span>
              {% else %}
                <span style="color: #9ca3af;">–</span>
              {% endif %}
            </td>
            <td style="padding: 1rem;">
              {% if s.approved %}
                <span class="badge" style="background-color: #059669;">✅ Genehmigt</span>
              {% else %}
                <span class="badge" style="background-color: #d97706;">⏳ Ausstehend</span>
              {% endif %}
            </td>
          </tr>
          {% else %}
          <tr>
            <td colspan="4" style="padding: 3rem 2rem; text-align: center; color: #64748b;">
              <div style="font-size: 4rem; margin-bottom: 1rem;">📊</div>
              <h3 style="margin-bottom: 0.5rem;">Keine Einsätze</h3>
              <p style="margin: 0;">Für diesen Monat sind noch keine Einsätze eingetragen.</p>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: 3rem 2rem; color: #64748b;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">📊</div>
      <h3 style="margin-bottom: 0.5rem;">Keine Einsätze</h3>
      <p style="margin: 0;">Für diesen Monat sind noch keine Einsätze eingetragen.</p>
    </div>
    {% endif %}
  </div>
</div>

<!-- Schnellzugriff -->
<div style="margin-top: 2rem; text-align: center;">
  <a href="{{ url_for('schedule') }}" class="btn btn-primary" style="padding: 0.75rem 1.5rem;">
    <span style="margin-right: 0.5rem;">📅</span>Zum Dienstplan
  </a>
</div>
{% endblock %}