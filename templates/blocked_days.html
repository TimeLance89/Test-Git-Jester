{% extends "layout.html" %}
{% block title %}Gesperrte Tage - Xerxes{% endblock %}
{% block content %}

<div style="margin-bottom: 2rem;">
  <h1 style="display: flex; align-items: center; margin-bottom: 0.5rem;">
    <span style="margin-right: 0.75rem; font-size: 2rem;">🚫</span>
    Gesperrte Tage
  </h1>
  <p style="color: #64748b; font-size: 1.125rem; margin: 0;">Verwaltung von Feiertagen, Betriebsferien und anderen gesperrten Tagen</p>
</div>

<!-- Aktionen -->
<div style="margin-bottom: 2rem;">
  <a href="{{ url_for('add_blocked_day') }}" class="btn btn-success">
    <span style="margin-right: 0.5rem;">➕</span>Neuen gesperrten Tag hinzufügen
  </a>
</div>

<!-- Gesperrte Tage Liste -->
<div class="card" style="border: none; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);">
  <div class="card-header" style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; border: none; padding: 2rem;">
    <h3 style="margin: 0; display: flex; align-items: center; font-size: 1.5rem; font-weight: 600;">
      <span style="margin-right: 0.75rem; font-size: 2rem;">📅</span>
      Übersicht der gesperrten Tage ({{ blocked_days|length }})
    </h3>
    <p style="margin: 0.5rem 0 0 0; opacity: 0.9; font-size: 1rem;">Alle eingetragenen Feiertage und Sperrtage</p>
  </div>
  <div class="card-body" style="padding: 0;">
    {% if blocked_days %}
    <div style="overflow-x: auto;">
      <table class="table" style="margin: 0;">
        <thead style="background-color: #f8fafc;">
          <tr>
            <th style="padding: 1.5rem 1rem; font-weight: 600; color: #374151;">
              <span style="margin-right: 0.5rem;">📅</span>Datum
            </th>
            <th style="padding: 1.5rem 1rem; font-weight: 600; color: #374151;">
              <span style="margin-right: 0.5rem;">🏷️</span>Name
            </th>
            <th style="padding: 1.5rem 1rem; font-weight: 600; color: #374151;">
              <span style="margin-right: 0.5rem;">📋</span>Typ
            </th>
            <th style="padding: 1.5rem 1rem; font-weight: 600; color: #374151;">
              <span style="margin-right: 0.5rem;">📝</span>Beschreibung
            </th>
            <th style="padding: 1.5rem 1rem; font-weight: 600; color: #374151; text-align: center;">
              <span style="margin-right: 0.5rem;">⚙️</span>Aktionen
            </th>
          </tr>
        </thead>
        <tbody>
          {% for blocked_day in blocked_days %}
          <tr style="border-bottom: 1px solid #e5e7eb;">
            <td style="padding: 1rem; font-weight: 500;">
              {{ blocked_day.date.strftime('%d.%m.%Y') }}
              <br><small style="color: #64748b;">{{ ['Montag', 'Dienstag', 'Mittwoch', 'Donnerstag', 'Freitag', 'Samstag', 'Sonntag'][blocked_day.date.weekday()] }}</small>
            </td>
            <td style="padding: 1rem;">
              <span style="font-weight: 600; color: #1e293b;">{{ blocked_day.name }}</span>
            </td>
            <td style="padding: 1rem;">
              {% if blocked_day.block_type == 'Feiertag' %}
                <span class="badge" style="background-color: #dc2626; color: white;">🎉 {{ blocked_day.block_type }}</span>
              {% elif blocked_day.block_type == 'Betriebsferien' %}
                <span class="badge" style="background-color: #f59e0b; color: white;">🏖️ {{ blocked_day.block_type }}</span>
              {% else %}
                <span class="badge" style="background-color: #64748b; color: white;">📋 {{ blocked_day.block_type }}</span>
              {% endif %}
            </td>
            <td style="padding: 1rem;">
              {% if blocked_day.description %}
                <span style="color: #64748b;">{{ blocked_day.description }}</span>
              {% else %}
                <span style="color: #9ca3af; font-style: italic;">Keine Beschreibung</span>
              {% endif %}
            </td>
            <td style="padding: 1rem; text-align: center;">
              <a href="{{ url_for('delete_blocked_day', blocked_day_id=blocked_day.id) }}" 
                 class="btn btn-sm btn-outline-danger"
                 onclick="return confirm('Gesperrten Tag {{ blocked_day.name }} wirklich löschen?')"
                 style="padding: 0.25rem 0.75rem;">
                <span style="margin-right: 0.25rem;">🗑️</span>Löschen
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div style="text-align: center; padding: 4rem 2rem; color: #64748b;">
      <div style="font-size: 4rem; margin-bottom: 1rem;">🚫</div>
      <h3 style="margin-bottom: 0.5rem; color: #374151;">Keine gesperrten Tage</h3>
      <p style="margin-bottom: 2rem;">Es sind noch keine Feiertage oder Sperrtage eingetragen.</p>
      <a href="{{ url_for('add_blocked_day') }}" class="btn btn-primary">
        <span style="margin-right: 0.5rem;">➕</span>Ersten gesperrten Tag hinzufügen
      </a>
    </div>
    {% endif %}
  </div>
</div>

{% if blocked_days %}
<div style="margin-top: 2rem; padding: 1.5rem; background-color: #f0f9ff; border: 1px solid #bae6fd; border-radius: 0.75rem;">
  <h4 style="color: #0369a1; margin-bottom: 1rem; display: flex; align-items: center;">
    <span style="margin-right: 0.5rem;">💡</span>Hinweise
  </h4>
  <ul style="color: #0369a1; margin: 0; padding-left: 1.5rem;">
    <li>Gesperrte Tage werden im Dienstplan entsprechend markiert</li>
    <li>An gesperrten Tagen können keine neuen Schichten eingeplant werden</li>
    <li>Bestehende Schichten an gesperrten Tagen bleiben erhalten</li>
    <li>Die automatische Schichtenerstellung berücksichtigt gesperrte Tage</li>
  </ul>
</div>
{% endif %}

{% endblock %}
